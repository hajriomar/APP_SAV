<div class="dashboard-container">
  <!-- En-tÃªte -->
  <div class="dashboard-header">
    <div>
      <h1>Tableau de bord</h1>
      <p class="welcome-text">Bienvenue, {{ currentUser?.prenom }} {{ currentUser?.nom }}</p>
    </div>
    <div class="header-actions">
      <button class="btn-icon" title="Actualiser" (click)="loadDashboardData()">
        <span>ğŸ”„</span>
      </button>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner"></div>
    <p>Chargement des donnÃ©es...</p>
  </div>

  <!-- Statistiques -->
  <div *ngIf="!isLoading" class="stats-grid">
    <div class="stat-card stat-primary">
      <div class="stat-icon">ğŸš—</div>
      <div class="stat-content">
        <h3>{{ stats.totalVehicules }}</h3>
        <p>VÃ©hicules</p>
      </div>
    </div>

    <div class="stat-card stat-warning">
      <div class="stat-icon">ğŸ“‹</div>
      <div class="stat-content">
        <h3>{{ stats.totalReclamations }}</h3>
        <p>RÃ©clamations</p>
        <span class="stat-badge" *ngIf="stats.reclamationsEnAttente > 0">
          {{ stats.reclamationsEnAttente }} en attente
        </span>
      </div>
    </div>

    <div class="stat-card stat-info">
      <div class="stat-icon">ğŸ“…</div>
      <div class="stat-content">
        <h3>{{ stats.totalRendezVous }}</h3>
        <p>Rendez-vous</p>
        <span class="stat-badge" *ngIf="stats.rendezVousAujourdhui > 0">
          {{ stats.rendezVousAujourdhui }} aujourd'hui
        </span>
      </div>
    </div>

    <div class="stat-card stat-success">
      <div class="stat-icon">ğŸ’°</div>
      <div class="stat-content">
        <h3>{{ stats.totalFactures }}</h3>
        <p>Factures</p>
      </div>
    </div>
  </div>

  <!-- Contenu principal -->
  <div *ngIf="!isLoading" class="dashboard-content">
    <!-- RÃ©clamations rÃ©centes -->
    <div class="content-card">
      <div class="card-header">
        <h2>RÃ©clamations rÃ©centes</h2>
        <a routerLink="/reclamations" class="link">Voir tout</a>
      </div>
      <div class="card-body">
        <div *ngIf="recentReclamations.length === 0" class="empty-state">
          <p>Aucune rÃ©clamation pour le moment</p>
        </div>
        <div *ngIf="recentReclamations.length > 0" class="list-container">
          <div *ngFor="let reclamation of recentReclamations" class="list-item">
            <div class="list-item-content">
              <h4>{{ reclamation.titre || 'RÃ©clamation #' + reclamation._id }}</h4>
              <p class="list-item-meta">
                <span>{{ formatDate(reclamation.date_creation || reclamation.create_date) }}</span>
                <span [class]="'badge ' + getEtatBadgeClass(reclamation.etat)">
                  {{ reclamation.etat || 'N/A' }}
                </span>
              </p>
            </div>
            <div class="list-item-action">
              <a [routerLink]="['/reclamations', reclamation._id]" class="btn-link">Voir</a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Prochains rendez-vous -->
    <div class="content-card">
      <div class="card-header">
        <h2>Prochains rendez-vous</h2>
        <a routerLink="/rendezvous" class="link">Voir tout</a>
      </div>
      <div class="card-body">
        <div *ngIf="upcomingRendezVous.length === 0" class="empty-state">
          <p>Aucun rendez-vous Ã  venir</p>
        </div>
        <div *ngIf="upcomingRendezVous.length > 0" class="list-container">
          <div *ngFor="let rdv of upcomingRendezVous" class="list-item">
            <div class="list-item-content">
              <h4>{{ rdv.description || 'Rendez-vous' }}</h4>
              <p class="list-item-meta">
                <span>ğŸ“… {{ formatDate(rdv.date) }}</span>
                <span *ngIf="rdv.heure">ğŸ• {{ rdv.heure }}</span>
                <span [class]="'badge ' + getEtatBadgeClass(rdv.etat)">
                  {{ rdv.etat || 'N/A' }}
                </span>
              </p>
            </div>
            <div class="list-item-action">
              <a [routerLink]="['/rendezvous', rdv._id]" class="btn-link">Voir</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
